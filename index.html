<!DOCTYPE html>
<html>
  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>




  <!-- we import arjs version without NFT but with marker + location based support -->
  <script src="aframe-ar.js"></script>

  <script>
  //So I can see in the console log if the updated version is running...
  console.log("*************")
  console.log("Update 37")
  console.log("*************")





  //Multiple Trackers
  AFRAME.registerComponent('registerevents', {
  		init: function () {
  			var marker = this.el;
        var markerId = marker.id;

  			marker.addEventListener('markerFound', function() {

  				console.log('markerFound', markerId);

          if (markerId == "anchor") {
  				// TODO: Add your own code here to react to the marker being found.
        //  alert("Marker Found!");
          window.open("https://dboxtest.s3.amazonaws.com/autogyro/tour.html?startscene=1&startactions=lookat(2.37,2.95,100,0,0)","_self");

        } else if (markerId == "anchor2") {
          window.open("https://dboxtest.s3.amazonaws.com/autogyro/tour.html?startscene=1&startactions=lookat(90,2.95,100,0,0)","_self");

        } else {}

  			});



  			marker.addEventListener('markerLost', function() {
  				var markerId = marker.id;
  				console.log('markerLost', markerId);
  				// TODO: Add your own code here to react to the marker being lost.
  			});
  		}
  	});




  </script>


  <body style="margin : 0px; overflow: hidden;">
    <button class="start-btn">Start compass</button>
    <a-scene embedded arjs vr-mode-ui="enabled: false">

      <a-marker preset='custom' type="pattern" url="pattern-Main_111_Murray_3.patt" emitevents="true" id="anchor" registerevents >
      </a-marker>

      <a-marker preset='hiro' emitevents="true" id="anchor2" registerevents>
      </a-marker>

     <a-entity camera></a-entity>
  </a-scene>



    <!--
    <a-scene embedded arjs>
      <a-marker-camera type="pattern" preset='custom' Url='111_main_pattern.patt'  emitevents="true" id="anchor" registerevents >
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  -->
  </body>

  <script>
  //Compass Section
  let compass;
  const isIOS = !(
  navigator.userAgent.match(/(iPod|iPhone|iPad)/) &&
  navigator.userAgent.match(/AppleWebKit/)
  );

  //Have to have a button somewhere to start the compass on iOS
  function init() {
    startBtn.addEventListener("click", startCompass);
  }

  function startCompass() {
    if (isIOS) {
      DeviceOrientationEvent.requestPermission()
        .then((response) => {
          if (response === "granted") {
            window.addEventListener("deviceorientation", handler, true);
          } else {
            alert("has to be allowed!");
          }
        })
        .catch(() => alert("not supported"));
    } else {
      window.addEventListener("deviceorientationabsolute", handler, true);
    }
  }

  function handler(e) {
    compass = e.webkitCompassHeading || Math.abs(e.alpha - 360);
    console.log("Compass:");
    console.log(compass);
  }

  init();

  </script>


</html>
